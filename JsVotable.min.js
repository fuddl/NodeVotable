var requirejs,require,define;(function(undef){var main,req,makeMap,handlers,defined={},waiting={},config={},defining={},hasOwn=Object.prototype.hasOwnProperty,aps=[].slice;function hasProp(obj,prop){return hasOwn.call(obj,prop)}function normalize(name,baseName){var nameParts,nameSegment,mapValue,foundMap,foundI,foundStarMap,starI,i,j,part,baseParts=baseName&&baseName.split("/"),map=config.map,starMap=map&&map["*"]||{};if(name&&name.charAt(0)==="."){if(baseName){baseParts=baseParts.slice(0,baseParts.length-1);name=baseParts.concat(name.split("/"));for(i=0;i<name.length;i+=1){part=name[i];if(part==="."){name.splice(i,1);i-=1}else if(part===".."){if(i===1&&(name[2]===".."||name[0]==="..")){break}else if(i>0){name.splice(i-1,2);i-=2}}}name=name.join("/")}else if(name.indexOf("./")===0){name=name.substring(2)}}if((baseParts||starMap)&&map){nameParts=name.split("/");for(i=nameParts.length;i>0;i-=1){nameSegment=nameParts.slice(0,i).join("/");if(baseParts){for(j=baseParts.length;j>0;j-=1){mapValue=map[baseParts.slice(0,j).join("/")];if(mapValue){mapValue=mapValue[nameSegment];if(mapValue){foundMap=mapValue;foundI=i;break}}}}if(foundMap){break}if(!foundStarMap&&starMap&&starMap[nameSegment]){foundStarMap=starMap[nameSegment];starI=i}}if(!foundMap&&foundStarMap){foundMap=foundStarMap;foundI=starI}if(foundMap){nameParts.splice(0,foundI,foundMap);name=nameParts.join("/")}}return name}function makeRequire(relName,forceSync){return function(){return req.apply(undef,aps.call(arguments,0).concat([relName,forceSync]))}}function makeNormalize(relName){return function(name){return normalize(name,relName)}}function makeLoad(depName){return function(value){defined[depName]=value}}function callDep(name){if(hasProp(waiting,name)){var args=waiting[name];delete waiting[name];defining[name]=true;main.apply(undef,args)}if(!hasProp(defined,name)&&!hasProp(defining,name)){throw new Error("No "+name)}return defined[name]}function splitPrefix(name){var prefix,index=name?name.indexOf("!"):-1;if(index>-1){prefix=name.substring(0,index);name=name.substring(index+1,name.length)}return[prefix,name]}makeMap=function(name,relName){var plugin,parts=splitPrefix(name),prefix=parts[0];name=parts[1];if(prefix){prefix=normalize(prefix,relName);plugin=callDep(prefix)}if(prefix){if(plugin&&plugin.normalize){name=plugin.normalize(name,makeNormalize(relName))}else{name=normalize(name,relName)}}else{name=normalize(name,relName);parts=splitPrefix(name);prefix=parts[0];name=parts[1];if(prefix){plugin=callDep(prefix)}}return{f:prefix?prefix+"!"+name:name,n:name,pr:prefix,p:plugin}};function makeConfig(name){return function(){return config&&config.config&&config.config[name]||{}}}handlers={require:function(name){return makeRequire(name)},exports:function(name){var e=defined[name];if(typeof e!=="undefined"){return e}else{return defined[name]={}}},module:function(name){return{id:name,uri:"",exports:defined[name],config:makeConfig(name)}}};main=function(name,deps,callback,relName){var cjsModule,depName,ret,map,i,args=[],usingExports;relName=relName||name;if(typeof callback==="function"){deps=!deps.length&&callback.length?["require","exports","module"]:deps;for(i=0;i<deps.length;i+=1){map=makeMap(deps[i],relName);depName=map.f;if(depName==="require"){args[i]=handlers.require(name)}else if(depName==="exports"){args[i]=handlers.exports(name);usingExports=true}else if(depName==="module"){cjsModule=args[i]=handlers.module(name)}else if(hasProp(defined,depName)||hasProp(waiting,depName)||hasProp(defining,depName)){args[i]=callDep(depName)}else if(map.p){map.p.load(map.n,makeRequire(relName,true),makeLoad(depName),{});args[i]=defined[depName]}else{throw new Error(name+" missing "+depName)}}ret=callback.apply(defined[name],args);if(name){if(cjsModule&&cjsModule.exports!==undef&&cjsModule.exports!==defined[name]){defined[name]=cjsModule.exports}else if(ret!==undef||!usingExports){defined[name]=ret}}}else if(name){defined[name]=callback}};requirejs=require=req=function(deps,callback,relName,forceSync,alt){if(typeof deps==="string"){if(handlers[deps]){return handlers[deps](callback)}return callDep(makeMap(deps,callback).f)}else if(!deps.splice){config=deps;if(callback.splice){deps=callback;callback=relName;relName=null}else{deps=undef}}callback=callback||function(){};if(typeof relName==="function"){relName=forceSync;forceSync=alt}if(forceSync){main(undef,deps,callback,relName)}else{setTimeout(function(){main(undef,deps,callback,relName)},4)}return req};req.config=function(cfg){config=cfg;if(config.deps){req(config.deps,config.callback)}return req};define=function(name,deps,callback){if(!deps.splice){callback=deps;deps=[]}if(!hasProp(defined,name)&&!hasProp(waiting,name)){waiting[name]=[name,deps,callback]}};define.amd={jQuery:true}})();define("../minify/almond",function(){});define("utils",[],function(){var Utils={};Utils.inherits=function(base,sub){function tempCtor(){}tempCtor.prototype=base.prototype;sub.prototype=new tempCtor;sub.prototype.constructor=sub};Utils.makeHttpObject=function(){try{return new XMLHttpRequest}catch(erreur){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(erreur){}try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(erreur){}throw new Error("The object creation for making HTTP requests has failed.")};Utils.guid=function(){function s4(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return s4()+s4()+"-"+s4()+"-"+s4()+"-"+s4()+"-"+s4()+s4()+s4()};Utils.findValueByKeyword=function(listKeywords,keyword){var result=undefined;for(i=0;i<listKeywords.length;i++){var currentKeyword=listKeywords[i];if(currentKeyword[0]===keyword){result=currentKeyword[1];break}}return result};Utils.parseXML=function(val){if(document.implementation&&document.implementation.createDocument){xmlDoc=(new DOMParser).parseFromString(val,"text/xml")}else if(window.ActiveXObject){xmlDoc=new ActiveXObject("Microsoft.XMLDOM");xmlDoc.loadXML(val)}else{alert("Your browser cannot handle this script");return null}return xmlDoc};return Utils});define("cache",[],function(){var Cache=function(){this.nodeID={};this.nodeName={};this.warnings=[]};Cache.prototype.getEltsByID=function(){return this.nodeID};Cache.prototype.getEltsByName=function(){return this.nodeName};Cache.prototype.getWarnings=function(){return this.warnings};Cache.prototype.addEntryID=function(id,node){this.nodeID[id]=node};Cache.prototype.addEntryName=function(name,node){if(this.nodeName.hasOwnProperty(name)){this.nodeName[name].push(node)}else{this.nodeName[name]=[];this.nodeName[name].push(node)}};Cache.prototype.addWarning=function(warning){this.warnings.push(warning)};return Cache});define("abstractNode",["./utils","./cache"],function(Utils,Cache){var AbstractNode=function(childNode,tagName){if(typeof tagName==="undefined"){throw new Error("tagName is undefined for "+childNode)}this.tagName=tagName;this.attributes={};if(childNode!=null&&childNode.nodeType==1){for(var i=0,l=childNode.attributes.length;i<l;i++){var attribute=childNode.attributes[i];this.attributes[attribute.name]=attribute.value}if(this.attributes.hasOwnProperty("ID")){var cache=Singleton.getInstance();cache.addEntryID(this.attributes["ID"],this)}if(this.attributes.hasOwnProperty("name")){var cache=Singleton.getInstance();cache.addEntryName(this.attributes["name"],this)}}};AbstractNode.prototype.getAttributes=function(){return this.attributes};AbstractNode.prototype.hasAttribute=function(name){return this.attributes.hasOwnProperty(name)};AbstractNode.prototype.hasAttributes=function(){return Object.keys(this.attributes).length==0?false:true};AbstractNode.prototype.getTagName=function(){return this.tagName};AbstractNode.prototype.getCache=function(){return Singleton.getInstance()};var Singleton=function(){var instance;function createInstance(){var object=new Cache;return object}return{getInstance:function(){if(!instance){instance=createInstance()}return instance}}}();return AbstractNode});define("constants",[],function(){var Constants=function(){};Constants.API={version:"2.0.0"};Constants.TAG={BINARY:"BINARY",BINARY2:"BINARY2",COOSYS:"COOSYS",DATA:"DATA",DEFINITIONS:"DEFINITIONS",DESCRIPTION:"DESCRIPTION",FIELD:"FIELD",FIELDref:"FIELDref",FITS:"FITS",GROUP:"GROUP",INFO:"INFO",VOTABLE:"VOTABLE",LINK:"LINK",MAX:"MAX",MIN:"MIN",OPTION:"OPTION",PARAM:"PARAM",PARAMref:"PARAMref",RESOURCE:"RESOURCE",STREAM:"STREAM",TABLE:"TABLE",TABLEDATA:"TABLEDATA",TD:"TD",TR:"TR",VALUES:"VALUES"};return Constants});define("description",["./utils","./abstractNode","./constants"],function(Utils,AbstractNode,Constants){var Description=function(childNode){AbstractNode.prototype.constructor.call(this,childNode,Constants.TAG.DESCRIPTION);this.value;var element=childNode.childNodes[0];if(element!=null&&element.nodeType==3){this.value=element.textContent==null?null:element.textContent.trim()}};Utils.inherits(AbstractNode,Description);Description.prototype.getContent=function(){return this.value};return Description});define("fieldref",["./utils","./abstractNode","./constants"],function(Utils,AbstractNode,Constants){var Fieldref=function(childNode){AbstractNode.prototype.constructor.call(this,childNode,Constants.TAG.FIELDref)};Utils.inherits(AbstractNode,Fieldref);Fieldref.prototype.ref=function(){return this.attributes["ref"]};Fieldref.prototype.ucd=function(){return this.attributes["ucd"]};Fieldref.prototype.utype=function(){return this.attributes["utype"]};return Fieldref});define("paramref",["./utils","./abstractNode","./constants"],function(Utils,AbstractNode,Constants){var Paramref=function(childNode){AbstractNode.prototype.constructor.call(this,childNode,Constants.TAG.PARAMref)};Utils.inherits(AbstractNode,Paramref);Paramref.prototype.ref=function(){return this.attributes["ref"]};Paramref.prototype.ucd=function(){return this.attributes["ucd"]};Paramref.prototype.utype=function(){return this.attributes["utype"]};return Paramref});define("min",["./utils","./abstractNode","./constants"],function(Utils,AbstractNode,Constants){var Min=function(childNode){AbstractNode.prototype.constructor.call(this,childNode,Constants.TAG.MIN)};Utils.inherits(AbstractNode,Min);Min.prototype.value=function(){return this.attributes["value"]};Min.prototype.inclusive=function(){return this.attributes["inclusive"]};return Min});define("max",["./utils","./abstractNode","./constants"],function(Utils,AbstractNode,Constants){var Max=function(childNode){AbstractNode.prototype.constructor.call(this,childNode,Constants.TAG.MAX)};Utils.inherits(AbstractNode,Max);Max.prototype.value=function(){return this.attributes["value"]};Max.prototype.inclusive=function(){return this.attributes["inclusive"]};return Max});define("option",["./utils","./abstractNode","./constants"],function(Utils,AbstractNode,Constants){var Option=function(childNode){AbstractNode.prototype.constructor.call(this,childNode,Constants.TAG.OPTION);var self=this;this.options=parseOptionTag(self,childNode)};var parseOptionTag=function(self,childNode){var options=[];for(var i=0;childNode!=null&&i<childNode.childNodes.length;i++){var element=childNode.childNodes[i];if(element.nodeType==1){var nodeName=element.localName;if(nodeName==Constants.TAG.OPTION){options.push(new Option(element))}else{self.getCache().addWarning("unknown element "+nodeName+" in Option node")}}}return options};Utils.inherits(AbstractNode,Option);Option.prototype.name=function(){return this.attributes["name"]};Option.prototype.value=function(){return this.attributes["value"]};Option.prototype.getOptions=function(){return this.options};return Option});define("values",["./utils","./abstractNode","./min","./max","./option","./constants"],function(Utils,AbstractNode,Min,Max,Option,Constants){var Values=function(childNode){AbstractNode.prototype.constructor.call(this,childNode,Constants.TAG.VALUES);var self=this;var result=parseValuesTag(self,childNode);this.min=result[0];this.max=result[1];this.options=result[2]};var parseValuesTag=function(self,childNode){var min;var max;var options=[];for(var i=0;childNode!=null&&i<childNode.childNodes.length;i++){var element=childNode.childNodes[i];if(element.nodeType==1){var nodeName=element.localName;switch(nodeName){case Constants.TAG.MIN:min=new Min(element);break;case Constants.TAG.MAX:max=new Max(element);break;case Constants.TAG.OPTION:options.push(new Option(element));break;default:self.getCache().addWarning("unknown element "+nodeName+" in Values node")}}}return[min,max,options]};Utils.inherits(AbstractNode,Values);Values.prototype.ID=function(){return this.attributes["ID"]};Values.prototype.type=function(){return this.attributes["type"]};Values.prototype.null=function(){return this.attributes["null"]};Values.prototype.ref=function(){return this.attributes["ref"]};Values.prototype.getMin=function(){return this.min};Values.prototype.getMax=function(){return this.max};Values.prototype.getOptions=function(){return this.options};return Values});define("link",["./utils","./abstractNode","./constants"],function(Utils,AbstractNode,Constants){var Link=function(childNode){AbstractNode.prototype.constructor.call(this,childNode,Constants.TAG.LINK)};Utils.inherits(AbstractNode,Link);Link.prototype.ID=function(){return this.attributes["ID"]};Link.prototype.content_role=function(){return this.attributes["content-role"]};Link.prototype.content_type=function(){return this.attributes["content-type"]};Link.prototype.title=function(){return this.attributes["title"]};Link.prototype.value=function(){return this.attributes["value"]};Link.prototype.href=function(){return this.attributes["href"]};Link.prototype.gref=function(){return this.attributes["gref"]};Link.prototype.action=function(){return this.attributes["action"]};return Link});define("field",["./utils","./abstractNode","./description","./values","./link","./constants"],function(Utils,AbstractNode,Description,Values,Link,Constants){var Field=function(childNode){AbstractNode.prototype.constructor.call(this,childNode,Constants.TAG.FIELD);var self=this;var result=parseField(self,childNode);this.description=result[0];this.values=result[1];this.links=result[2]};var parseField=function(self,childNode){var description;var values;var links=[];for(var i=0;childNode!=null&&i<childNode.childNodes.length;i++){var element=childNode.childNodes[i];if(element.nodeType==1){var nodeName=element.localName;switch(nodeName){case Constants.TAG.DESCRIPTION:description=new Description(element);break;case Constants.TAG.VALUES:values=new Values(element);break;case Constants.TAG.LINK:links.push(new Link(element));break;default:self.getCache().addWarning("unknown element "+nodeName+" in Field node")}}}return[description,values,links]};Utils.inherits(AbstractNode,Field);Field.prototype.ID=function(){return this.attributes["ID"]};Field.prototype.unit=function(){return this.attributes["unit"]};Field.prototype.datatype=function(){return this.attributes["datatype"]};Field.prototype.precision=function(){return this.attributes["precision"]};Field.prototype.width=function(){return this.attributes["width"]};Field.prototype.xtype=function(){return this.attributes["xtype"]};Field.prototype.ref=function(){return this.attributes["ref"]};Field.prototype.name=function(){return this.attributes["name"]};Field.prototype.ucd=function(){return this.attributes["ucd"]};Field.prototype.utype=function(){return this.attributes["utype"]};Field.prototype.arraysize=function(){return this.attributes["arraysize"]};Field.prototype.type=function(){return this.attributes["type"]};Field.prototype.getDescription=function(){return this.description};Field.prototype.getValues=function(){return this.values};Field.prototype.getLinks=function(){return this.links};return Field});define("param",["./utils","./field","./constants"],function(Utils,Field,Constants){var Param=function(childNode){Field.prototype.constructor.call(this,childNode,Constants.TAG.PARAM)};Utils.inherits(Field,Param);Param.prototype.value=function(){return this.attributes["value"]};return Param});define("group",["./utils","./abstractNode","./description","./fieldref","./paramref","./param","./constants"],function(Utils,AbstractNode,Description,Fieldref,Paramref,Param,Constants){var Group=function(childNode){AbstractNode.prototype.constructor.call(this,childNode,Constants.TAG.GROUP);var self=this;var result=parseGroup(self,childNode);this.description=result[0];this.fieldrefs=result[1];this.paramrefs=result[2];this.params=result[3];this.groups=result[4]};var parseGroup=function(self,childNode){var description;var fieldrefs=[];var paramrefs=[];var params=[];var groups=[];for(var i=0;childNode!=null&&i<childNode.childNodes.length;i++){var element=childNode.childNodes[i];if(element.nodeType==1){var nodeName=element.localName;switch(nodeName){case Constants.TAG.DESCRIPTION:description=new Description(element);break;case Constants.TAG.FIELDref:fieldrefs.push(new Fieldref(element));break;case Constants.TAG.PARAMref:paramrefs.push(new Paramref(element));break;case Constants.TAG.PARAM:params.push(new Param(element));break;case Constants.TAG.GROUP:groups.push(new Group(element));break;default:self.getCache().addWarning("unknown element "+nodeName+" in Group node")}}}return[description,fieldrefs,paramrefs,params,groups]};Utils.inherits(AbstractNode,Group);Group.prototype.ID=function(){return this.attributes["ID"]};Group.prototype.name=function(){return this.attributes["name"]};Group.prototype.ref=function(){return this.attributes["ref"]};Group.prototype.ucd=function(){return this.attributes["ucd"]};Group.prototype.utype=function(){return this.attributes["utype"]};Group.prototype.getDescription=function(){return this.description};Group.prototype.getFieldrefs=function(){return this.fieldrefs};Group.prototype.getParamrefs=function(){return this.paramrefs};Group.prototype.getParams=function(){return this.params};Group.prototype.getGroups=function(){return this.groups};return Group});define("coosys",["./utils","./abstractNode","./constants"],function(Utils,AbstractNode,Constants){var Coosys=function(childNode){AbstractNode.prototype.constructor.call(this,childNode,Constants.TAG.COOSYS);var self=this;this.value=parseCoordinateSystem(self,childNode)};Utils.inherits(AbstractNode,Coosys);var parseCoordinateSystem=function(self,childNode){var value;for(var i=0;childNode!=null&&i<childNode.childNodes.length;i++){var element=childNode.childNodes[i];if(element!=null&&element.nodeType==3){value=element.textContent==null?null:element.textContent.trim()}else{self.getCache().addWarning("unknown element "+element+" in Coosys node")}}return value};Coosys.prototype.ID=function(){return this.attributes["ID"]};Coosys.prototype.equinox=function(){return this.attributes["equinox"]};Coosys.prototype.epoch=function(){return this.attributes["epoch"]};Coosys.prototype.system=function(){return this.attributes["system"]};Coosys.prototype.getContent=function(){return this.value};return Coosys});define("definitions",["./utils","./abstractNode","./group","./param","./coosys","./constants"],function(Utils,AbstractNode,Group,Param,Coosys,Constants){var Definitions=function(childNode){AbstractNode.prototype.constructor.call(this,childNode,Constants.TAG.DEFINITIONS);var self=this;var result=parseDefinitions(self,childNode);this.coosys=result[0];this.param=result[1]};var parseDefinitions=function(self,childNode){var coosyss=[];var params=[];for(var i=0;childNode!=null&&i<childNode.childNodes.length;i++){var element=childNode.childNodes[i];if(element.nodeType==1){var nodeName=element.localName;switch(nodeName){case Constants.TAG.COOSYS:coosyss.push(new Coosys(element));break;case Constants.TAG.PARAM:params.push(new Param(element));break;default:self.getCache().addWarning("unknown element "+nodeName+" in Definitions node")}if(nodeName==Constants.TAG.COOSYS){coosyss.push(new Coosys(element))}else if(nodeName==Constants.TAG.PARAM){params.push(new Param(element))}else{self.getCache().addWarning("unknown element "+nodeName+" in Definitions node")}}}return[coosyss,params]};Utils.inherits(AbstractNode,Definitions);Definitions.prototype.getCoosyss=function(){return this.coosys};Definitions.prototype.getParams=function(){return this.param};return Definitions});define("info",["./utils","./abstractNode","./constants"],function(Utils,AbstractNode,Constants){var Info=function(childNode){AbstractNode.prototype.constructor.call(this,childNode,Constants.TAG.INFO);var element=childNode.childNodes[0];if(element!=null&&element.nodeType==3){this.val=element.textContent==null?null:element.textContent.trim()}};Info.prototype.name=function(){return this.attributes["name"]};Info.prototype.value=function(){return this.attributes["value"]};Info.prototype.ID=function(){return this.attributes["ID"]};Info.prototype.unit=function(){return this.attributes["unit"]};Info.prototype.xtype=function(){return this.attributes["xtype"]};Info.prototype.ref=function(){return this.attributes["ref"]};Info.prototype.ucd=function(){return this.attributes["ucd"]};Info.prototype.utype=function(){return this.attributes["utype"]};Info.prototype.getContent=function(){return this.val};return Info});define("td",["./utils","./abstractNode","./constants"],function(Utils,AbstractNode,Constants){var Td=function(childNode,options){AbstractNode.prototype.constructor.call(this,childNode,Constants.TAG.TD);if(options==null){this.value=childNode.textContent==null?"":childNode.textContent.trim()}else{this.value=options==null?"":options.trim()}};Utils.inherits(AbstractNode,Td);Td.prototype.encoding=function(){return this.attributes["encoding"]};Td.prototype.getContent=function(){return this.value};return Td});define("tr",["./utils","./abstractNode","./td","./constants"],function(Utils,AbstractNode,Td,Constants){var Tr=function(childNode,options){AbstractNode.prototype.constructor.call(this,childNode,Constants.TAG.TR);if(options==null){var self=this;this.tds=parseTr(self,childNode)}else{this.tds=[];for(var i=0;i<options.length;i++){this.tds.push(new Td(null,options[i]))}}};var parseTr=function(self,childNode){var tds=[];for(var i=0;childNode!=null&&i<childNode.childNodes.length;i++){var element=childNode.childNodes[i];if(element.nodeType==1){var nodeName=element.localName;if(nodeName==Constants.TAG.TD){tds.push(new Td(element))}else{self.getCache().addWarning("unknown element "+nodeName+" in Tr node")}}}return tds};Utils.inherits(AbstractNode,Tr);Tr.prototype.ID=function(){return this.attributes["ID"]};Tr.prototype.getTds=function(){return this.tds};return Tr});define("abstractData",["./utils","./abstractNode"],function(Utils,AbstractNode){var AbstractData=function(childNode,name){AbstractNode.prototype.constructor.call(this,childNode,name)};Utils.inherits(AbstractNode,AbstractData);return AbstractData});define("tabledata",["./utils","./tr","./abstractData","./constants"],function(Utils,Tr,AbstractData,Constants){var TableData=function(childNode,options){AbstractData.prototype.constructor.call(this,childNode,Constants.TAG.TABLEDATA);if(options==null){var self=this;this.trs=parseTableData(self,childNode)}else{this.trs=[];for(var i=0;i<options.length;i++){this.trs.push(new Tr(null,options[i]))}}};var parseTableData=function(self,childNode){var trs=[];for(var i=0;childNode!=null&&i<childNode.childNodes.length;i++){var element=childNode.childNodes[i];if(element.nodeType==1){var nodeName=element.localName;if(nodeName==Constants.TAG.TR){trs.push(new Tr(element))}else{self.getCache().addWarning("unknown element "+nodeName+" in TableData node")}}}return trs};Utils.inherits(AbstractData,TableData);TableData.prototype.getTrs=function(){return this.trs};return TableData});define("converter/base64",[],function(){var TAB_DATA_SIZE={short:16,int:32,float:32,double:64,unsignedByte:8};var Base64=function(fields){this.ptrStream=0;this.bufferTabBits=[];this.fields=fields};Base64.prototype.computeDataSize=function(datatype,fieldNumber,stream){var dataSize=0;if(datatype==="char"){if(/\*/.test(this.fields[fieldNumber].arraysize())){var tabBits=this.streamB64(32,stream);dataSize=8*bin2uint32(tabBits);tabBits=[]}else{dataSize=8*this.fields[fieldNumber].arraysize()}}else{dataSize=TAB_DATA_SIZE[datatype]}return dataSize};Base64.prototype.streamB64=function(datasize,stream){var tabBits=[];var bufferLength=this.bufferTabBits.length;var needBit=Math.ceil((datasize-bufferLength)/6);for(var i=0;i<bufferLength;i+=1){tabBits.push(this.bufferTabBits[i])}this.bufferTabBits=[];for(var i=0;i<needBit;i+=1){if(stream.charCodeAt(this.ptrStream)==10){i-=1}else{var nb=b64ToUint6(stream.charCodeAt(this.ptrStream));for(var z=32;z>0;z>>=1){if(tabBits.length!==datasize){tabBits.push((nb&z)===z?"1":"0")}else{this.bufferTabBits.push((nb&z)===z?"1":"0")}}}this.ptrStream+=1}return tabBits};Base64.prototype.decodeValue=function(datatype,datasize,fieldNumber,stream){var value;var tabBits=[];if(datatype!="NULL"){tabBits=this.streamB64(datasize,stream)}switch(datatype){case"short":value=bin2short16(tabBits);break;case"int":value=bin2int32(tabBits);break;case"float":value=bin2float32(tabBits);value=value.toFixed(this.fields[fieldNumber].precision());break;case"double":value=bin2double64(tabBits);value=value.toFixed(this.fields[fieldNumber].precision());break;case"unsignedByte":value=bin2ubyte8(tabBits);break;case"char":value=bin2string(tabBits);break;case"NULL":value="NULL";break}if(value==="NaN"||value==="NULL"||value===0){value=""}return value};Base64.prototype.decode=function(stream){var trs=[];var fieldNumber=0;var tabBits=[];var streamLength=stream.length;var nbFields=this.fields.length;var tds=[];do{var datatype=this.fields[fieldNumber].datatype();var datasize=this.computeDataSize(datatype,fieldNumber,stream);if(datasize==0){datatype="NULL"}var value=this.decodeValue(datatype,datasize,fieldNumber,stream);tds.push(value);if(fieldNumber===nbFields-1){fieldNumber=0;trs.push(tds);tds=[]}else{fieldNumber+=1}}while(this.ptrStream<streamLength);return trs};function bin2short16(TabBits){"use strict";var buffer,dataview,binary;buffer=new ArrayBuffer(2);dataview=new DataView(buffer);binary=TabBits.join("");dataview.setUint16(0,parseInt(binary,2));return dataview.getInt16(0)}function bin2int32(TabBits){"use strict";var buffer,dataview,binary;buffer=new ArrayBuffer(4);dataview=new DataView(buffer);binary=TabBits.join("");dataview.setUint32(0,parseInt(binary,2));return dataview.getInt32(0)}function bin2float32(TabBits){"use strict";var buffer,dataview,binary;buffer=new ArrayBuffer(4);dataview=new DataView(buffer);binary=TabBits.join("");dataview.setUint32(0,parseInt(binary,2));return dataview.getFloat32(0)}function bin2double64(TabBits){"use strict";var buffer,dataview,lenght,binary;buffer=new ArrayBuffer(8);dataview=new DataView(buffer);binary=TabBits.slice(0,32).join("");dataview.setUint32(0,parseInt(binary,2));binary="";binary=TabBits.slice(32,64).join("");dataview.setUint32(4,parseInt(binary,2));return dataview.getFloat64(0)}function bin2ubyte8(TabBits){"use strict";var buffer,dataview,binary;buffer=new ArrayBuffer(1);dataview=new DataView(buffer);binary=TabBits.join("");dataview.setUint8(0,parseInt(binary,2));return dataview.getUint8(0)}function bin2string(TabBits){"use strict";var lenght,binary,i,j,str;lenght=TabBits.length/8;binary=[];str="";j=0;for(i=0;i<lenght;i+=1){binary=TabBits.slice(j,j+8);str=str.concat(String.fromCharCode(bin2ubyte8(binary)));binary=[];j+=8}return str}function bin2uint32(TabBits){"use strict";var buffer,dataview,binary;buffer=new ArrayBuffer(4);dataview=new DataView(buffer);binary=TabBits.join("");dataview.setUint32(0,parseInt(binary,2));return dataview.getUint32(0)}function b64ToUint6(caractere){var byte;if(caractere>64&&caractere<91){byte=caractere-65}else if(caractere>96&&caractere<123){byte=caractere-71}else if(caractere>47&&caractere<58){byte=caractere+4}else if(caractere===43){byte=62}else if(caractere===47){byte=63}return byte}return Base64});define("stream",["./utils","./abstractNode","./converter/base64","./tabledata","./constants"],function(Utils,AbstractNode,Base64,TableData,Constants){var Stream=function(childNode){AbstractNode.prototype.constructor.call(this,childNode,Constants.TAG.STREAM);this.value=childNode.textContent};Utils.inherits(AbstractNode,Stream);Stream.prototype.type=function(){return this.attributes["type"]};Stream.prototype.href=function(){return this.attributes["href"]};Stream.prototype.actuate=function(){return this.attributes["actuate"]};Stream.prototype.encoding=function(){return this.attributes["encoding"]};Stream.prototype.expires=function(){return this.attributes["expires"]};Stream.prototype.rights=function(){return this.attributes["rights"]};Stream.prototype.getContent=function(decode,fields){var result;if(decode==null||decode==false){result=this.value}else{var base64=new Base64(fields);result=new TableData(null,base64.decode(this.value))}return result};return Stream});define("binary",["./utils","./stream","./abstractData","./constants"],function(Utils,Stream,AbstractData,Constants){var Binary=function(childNode){AbstractData.prototype.constructor.call(this,childNode,Constants.TAG.BINARY);this.stream=parseBinary(childNode)};var parseBinary=function(childNode){var stream;for(var i=0;childNode!=null&&i<childNode.childNodes.length;i++){var element=childNode.childNodes[i];if(element.nodeType==1){var nodeName=element.localName;if(nodeName==Constants.TAG.STREAM){stream=new Stream(element)}else{throw new Error("Unknown element")}}}return stream};Utils.inherits(AbstractData,Binary);Binary.prototype.getStream=function(){return this.stream};return Binary});define("binary2",["./utils","./stream","./abstractData","./constants"],function(Utils,Stream,AbstractData,Constants){var Binary2=function(childNode){AbstractData.prototype.constructor.call(this,childNode,Constants.TAG.BINARY2);var self=this;this.stream=parseBinary2(self,childNode)};var parseBinary2=function(self,childNode){var stream;for(var i=0;childNode!=null&&i<childNode.childNodes.length;i++){var element=childNode.childNodes[i];if(element.nodeType==1){var nodeName=element.localName;if(nodeName==Constants.TAG.STREAM){stream=new Definitions(element)}else{self.getCache().addWarning("unknown element "+nodeName+" in Binary2 node")}}}return stream};Utils.inherits(AbstractData,Binary2);Binary2.prototype.getStream=function(){return this.stream};return Binary2});define("fits",["./utils","./abstractData","./stream","./constants"],function(Utils,AbstractData,Stream,Constants){var Fits=function(childNode){AbstractData.prototype.constructor.call(this,childNode,Constants.TAG.FITS);var self=this;this.stream=parseFits(self,childNode)};var parseFits=function(self,childNode){var stream;for(var i=0;childNode!=null&&i<childNode.childNodes.length;i++){var element=childNode.childNodes[i];if(element.nodeType==1){var nodeName=element.localName;if(nodeName==Constants.TAG.STREAM){stream=new Definitions(element)}else{self.getCache().addWarning("unknown element "+nodeName+" in Fits node")}}}return stream};Utils.inherits(AbstractData,Fits);Fits.prototype.getStream=function(){return this.stream};Fits.prototype.extnum=function(){return this.attributes["extnum"]};return Fits});define("data",["./utils","./abstractNode","./tabledata","./binary","./binary2","./fits","./info","./constants"],function(Utils,AbstractNode,TableData,Binary,Binary2,Fits,Info,Constants){var Data=function(childNode){AbstractNode.prototype.constructor.call(this,childNode,Constants.TAG.DATA);var self=this;var result=parseData(self,childNode);this.data=result[0];this.infos=result[1]};var parseData=function(self,childNode){var data;var infos=[];for(var i=0;childNode!=null&&i<childNode.childNodes.length;i++){var element=childNode.childNodes[i];if(element.nodeType==1){var nodeName=element.localName;switch(nodeName){case Constants.TAG.TABLEDATA:data=new TableData(element);break;case Constants.TAG.BINARY:data=new Binary(element);break;case Constants.TAG.BINARY2:data=new Binary2(element);break;case Constants.TAG.FITS:data=new Fits(element);break;case Constants.TAG.INFO:infos.push(new Info(element));break;default:
self.getCache().addWarning("unknown element "+nodeName+" in Data node")}}}return[data,infos]};Utils.inherits(AbstractNode,Data);Data.prototype.getData=function(){return this.data};Data.prototype.getDataImplementationName=function(){return this.data.getTagName()};Data.prototype.getInfos=function(){return this.infos};return Data});define("table",["./utils","./abstractNode","./description","./field","./param","./group","./link","./data","./info","./constants"],function(Utils,AbstractNode,Description,Field,Param,Group,Link,Data,Info,Constants){var Table=function(childNode){AbstractNode.prototype.constructor.call(this,childNode,Constants.TAG.TABLE);var self=this;var result=parseTable(self,childNode);this.fields=result[0];this.params=result[1];this.groups=result[2];this.links=result[3];this.data=result[4];this.description=result[5];this.infos=result[6]};var parseTable=function(self,childNodes){var fields=[];var params=[];var groups=[];var links=[];var data;var description;var infos=[];for(var i=0;childNodes!=null&&i<childNodes.childNodes.length;i++){var element=childNodes.childNodes[i];if(element.nodeType==1){var nodeName=element.localName;switch(nodeName){case Constants.TAG.DESCRIPTION:description=new Description(element);break;case Constants.TAG.FIELD:fields.push(new Field(element));break;case Constants.TAG.PARAM:params.push(new Param(element));break;case Constants.TAG.GROUP:groups.push(new Group(element));break;case Constants.TAG.LINK:links.push(new Link(element));break;case Constants.TAG.DATA:data=new Data(element);break;case Constants.TAG.INFO:infos.push(new Info(element));break;default:self.getCache().addWarning("unknown element "+nodeName+" in Table node")}}}return[fields,params,groups,links,data,description,infos]};Utils.inherits(AbstractNode,Table);Table.prototype.ID=function(){return this.attributes["ID"]};Table.prototype.name=function(){return this.attributes["name"]};Table.prototype.ref=function(){return this.attributes["ref"]};Table.prototype.ucd=function(){return this.attributes["ucd"]};Table.prototype.utype=function(){return this.attributes["utype"]};Table.prototype.nrows=function(){return this.attributes["nrows"]};Table.prototype.getFields=function(){return this.fields};Table.prototype.getParams=function(){return this.params};Table.prototype.getGroups=function(){return this.groups};Table.prototype.getLinks=function(){return this.links};Table.prototype.getData=function(){return this.data};Table.prototype.getInfos=function(){return this.infos};Table.prototype.getDescription=function(){return this.description};return Table});define("resource",["./utils","./abstractNode","./description","./info","./table","./link","./coosys","./param","./group","./constants"],function(Utils,AbstractNode,Description,Info,Table,Link,Coosys,Param,Group,Constants){var Resource=function(childNode){AbstractNode.prototype.constructor.call(this,childNode,Constants.TAG.RESOURCE);var self=this;var result=parseResource(self,childNode);this.description=result[0];this.infos=result[1];this.coosyss=result[2];this.params=result[3];this.groups=result[4];this.abstractSequences=result[5]};var parseResource=function(self,childNode){var description;var infos=[];var coosyss=[];var groups=[];var params=[];var abstractSequences=[];var end=0;var nbFound=0;for(var i=0;childNode!=null&&i<childNode.childNodes.length;i++){var element=childNode.childNodes[i];if(element.nodeType==1){var nodeName=element.localName;switch(nodeName){case Constants.TAG.DESCRIPTION:description=new Description(element);nbFound++;break;case Constants.TAG.INFO:infos.push(new Info(element));nbFound++;break;case Constants.TAG.COOSYS:coosyss.push(new Coosys);nbFound++;break;case Constants.TAG.GROUP:groups.push(new Group);nbFound++;break;case Constants.TAG.PARAM:params.push(new Param);nbFound++;break;default:end=i}}if(end!=0){break}}if(nbFound>end){end=nbFound}for(var i=end;childNode!=null&&i<childNode.childNodes.length;i++){var seqElts={};var seqLinks=[];var seqInfos=[];var element=childNode.childNodes[i];if(element.nodeType==1){var nodeName=element.localName;switch(nodeName){case Constants.TAG.LINK:seqLinks.push(new Link(element));break;case Constants.TAG.TABLE:seqElts["TABLE"]=new Table(element);if(seqLinks.length!=0){seqElts["LINKS"]=seqLinks;abstractSequences.push(seqElts["LINKS"]);seqElts["LINKS"]=[];seqLinks=[]}if(seqInfos.length!=0){seqElts["INFOS"]=seqInfos;abstractSequences.push(seqElts["INFOS"]);seqElts["INFOS"]=[];seqInfos=[]}abstractSequences.push(seqElts["TABLE"]);break;case Constants.TAG.RESOURCE:seqElts["RESOURCE"]=new Resource(element);if(seqLinks.length!=0){seqElts["LINKS"]=seqLinks;abstractSequences.push(seqElts["LINKS"]);seqElts["LINKS"]=[];seqLinks=[]}if(seqInfos.length!=0){seqElts["INFOS"]=seqInfos;abstractSequences.push(seqElts["INFOS"]);seqElts["INFOS"]=[];seqInfos=[]}abstractSequences.push(seqElts["RESOURCE"]);break;case Constants.TAG.INFO:seqInfos.push(new Info(element));if(i==childNode.childNodes.length-1){abstractSequences.push(seqInfos)}break;default:self.getCache().addWarning("Unkknown element "+nodeName+" in RESOURCE node")}}}return[description,infos,coosyss,params,groups,abstractSequences]};Utils.inherits(AbstractNode,Resource);Resource.prototype.ID=function(){return this.attributes["ID"]};Resource.prototype.name=function(){return this.attributes["name"]};Resource.prototype.utype=function(){return this.attributes["utype"]};Resource.prototype.type=function(){return this.attributes["type"]};Resource.prototype.getDescription=function(){return this.description};Resource.prototype.getInfos=function(){return this.infos};Resource.prototype.getCoosyss=function(){return this.coosyss};Resource.prototype.getGroups=function(){return this.groups};Resource.prototype.getParams=function(){return this.params};Resource.prototype.getResourcesOrTables=function(){return this.abstractSequences};return Resource});define("converter/geojson",["../utils","../constants"],function(Utils,Constants){var UCD_ID=["meta.record","meta.id;meta.main","VOX:Image_Titleq"];var UCD_RA=["pos.eq.ra;meta.main","POS_EQ_RA_MAIN"];var UCD_DEC=["pos.eq.dec;meta.main","POS_EQ_DEC_MAIN"];var GeoJson=function(votable){this.votable=votable;this.featureCollection=process(this.votable)};GeoJson.prototype.getGeoJSon=function(option){var pretty=option|false;return JSON.stringify(this.featureCollection,null,pretty)};function process(votable){var featureCollection={type:"FeatureCollection",features:[]};var coosys=findAndGetGlobalCoosys(votable);if(coosys!=null){featureCollection["crs"]={type:"name",properties:{name:coosys}}}var features=[];var resources=votable.getResources();for(var i=0;i<resources.length;i++){processResource(resources[i],features)}featureCollection["features"]=features;function findAndGetGlobalCoosys(votable){var coosys;var defs=votable.getDefinitions();if(defs!=null){coosys=defs.getCoosyss()[0]}if(votable.getCoosyss()[0]!=null){coosys=votable.getCoosyss()[0]}return coosys}return featureCollection}function processResource(resource,features){var resourcesOrTables=resource.getResourcesOrTables();for(var i=0;i<resourcesOrTables.length;i++){var resourceOrTable=resourcesOrTables[i];if(resourceOrTable.getTagName()==Constants.TAG.RESOURCE){processResource(resourceOrTable,features)}else if(resourceOrTable.getTagName()==Constants.TAG.TABLE){processTable(resourceOrTable,features)}}}function processTable(table,features){var fields=table.getFields();var data=table.getData();var trs;var infos=table.getInfos();switch(data.getDataImplementationName()){case Constants.TAG.TABLEDATA:var tableData=data.getData();trs=tableData.getTrs();break;case Constants.TAG.BINARY:var binary=data.getData();var tableData=binary.getStream().getContent(true,fields);trs=tableData.getTrs();break;case Constants.TAG.BINARY2:var binary2=data.getData();throw new Error("Binary2 not implemented");break;case Constants.TAG.FITS:var fits=data.getData();throw new Error("Fits not implemented");break;default:throw new Error("Type of data not implemented for "+table)}creatureFeatures(fields,infos,trs,features)}function creatureFeatures(fields,infos,trs,features){for(var i=0;i<trs.length;i++){var tds=trs[i].getTds();features.push(createFeature(fields,infos,tds))}}function createFeature(fields,infos,tds){var feature={type:"Feature",geometry:null,properties:{}};var coreMetadata={};for(var i=0;i<tds.length;i++){var td=tds[i];var field=fields[i];var values=field.getValues();var nullValue=values!=null?values.null():null;var ucd=field.ucd();var datatype=field.datatype();var value=td.getContent();var name=field.name();if(filter(UCD_RA,ucd)){coreMetadata["RA"]=Number.parseFloat(value);coreMetadata["COOSYS"]=field.ref()}else if(filter(UCD_DEC,ucd)){coreMetadata["DEC"]=Number.parseFloat(value)}else if(filter(UCD_ID,ucd)){coreMetadata["ID"]=value}else{var properties=feature.properties;if(value!=nullValue){properties[name]=parseDatatype(value,datatype)}}}if(!coreMetadata.hasOwnProperty("ID")){coreMetadata["ID"]=Utils.guid()}for(var i=0;i<infos.length;i++){var info=infos[i];properties[info.name()]=info.value()}checkCoreMetadata(coreMetadata);var geometry={type:"Point",coordinates:[coreMetadata.RA,coreMetadata.DEC],crs:{type:"name",properties:{name:coreMetadata.COOSYS}}};feature["geometry"]=geometry;function checkCoreMetadata(coreMetadata){if(!(coreMetadata.hasOwnProperty("RA")&&coreMetadata.hasOwnProperty("DEC")&&coreMetadata.hasOwnProperty("COOSYS")&&coreMetadata.hasOwnProperty("ID"))){throw new Error("core metadata missing "+JSON.stringify(coreMetadata))}}function parseDatatype(value,type){var result;switch(type){case"short":case"int":case"long":result=Number.parseInt(value);break;case"float":case"double":result=Number.parseFloat(value);break;default:result=value}return result}function filter(arr,criteria){var result=arr.filter(function(obj){return obj===criteria});return result.length==0?false:true}return feature}return GeoJson});define("votable",["./utils","./abstractNode","./definitions","./info","./resource","./description","./coosys","./group","./param","./converter/geojson","./constants"],function(Utils,AbstractNode,Definitions,Info,Resource,Description,Coosys,Group,Param,GeoJson,Constants){var Votable=function(xml){xml=checkInputFormat(xml);var childNode=xml.documentElement;AbstractNode.prototype.constructor.call(this,childNode,Constants.TAG.VOTABLE);var self=this;var result=parseVotableTag(self,childNode);this.definitions=result[0];this.infos=result[1];this.resources=result[2];this.description=result[3];this.coosyss=result[4];this.groups=result[5];this.params=result[6]};function checkInputFormat(xml){if(xml==null){throw new Error("xml cannot be null")}else if(typeof xml==="string"){var parser=new DOMParser;xml=parser.parseFromString(xml,"application/xml")}else if(xml.documentElement!=null){}else{throw new Error("This object is not supported")}var tag=xml.documentElement.localName;if(tag!=Constants.TAG.VOTABLE){throw new Error("This input is not a VOTable")}return xml}var parseVotableTag=function(self,childNode){var root=childNode;var definitions;var infos=[];var resources=[];var description;var coosyss=[];var groups=[];var params=[];for(var i=0;i<root.childNodes.length;i++){var element=root.childNodes[i];if(element.nodeType==1){var nodeName=element.localName;switch(nodeName){case Constants.TAG.DEFINITIONS:definitions=new Definitions(element);break;case Constants.TAG.INFO:infos.push(new Info(element));break;case Constants.TAG.RESOURCE:resources.push(new Resource(element));break;case Constants.TAG.DESCRIPTION:description=new Description(element);break;case Constants.TAG.COOSYS:coosyss.push(new Coosys(element));break;case Constants.TAG.GROUP:groups.push(new Group(element));break;case Constants.TAG.PARAM:params.push(new Param(element));break;default:self.getCache().addWarning("unknown element "+nodeName+" in Votable node")}}}return[definitions,infos,resources,description,coosyss,groups,params]};Utils.inherits(AbstractNode,Votable);Votable.prototype.ID=function(){return this.attributes["ID"]};Votable.prototype.version=function(){return this.attributes["version"]};Votable.prototype.getInfos=function(){return this.infos};Votable.prototype.getDefinitions=function(){return this.definitions};Votable.prototype.getResources=function(){return this.resources};Votable.prototype.getCoosyss=function(){return this.coosyss};Votable.prototype.getGroups=function(){return this.groups};Votable.prototype.getParams=function(){return this.params};Votable.prototype.getDescription=function(){return this.description};Votable.prototype.getVotableEltByID=function(ID){return this.getCache().getEltsByID()[ID]};Votable.prototype.getVotableEltsByName=function(name){return this.getCache().getEltsByName()[name]};Votable.prototype.convertToGeoJSon=function(option){var geoJson=new GeoJson(this);return geoJson.getGeoJSon(option)};return Votable});define("JsVotable",["./votable","./binary","./binary2","./coosys","./data","./definitions","./description","./field","./fieldref","./fits","./group","./info","./link","./max","./min","./option","./param","./paramref","./resource","./stream","./table","./tabledata","./td","./tr","./values","./constants"],function(Votable,Binary,Binary2,Coosys,Data,Definitions,Description,Field,Fieldref,Fits,Group,Info,Link,Max,Min,Option,Param,Paramref,Resource,Stream,Table,TableData,Td,Tr,Values,Constants){var JsVotable={};JsVotable.Constants=Constants;JsVotable.Votable=Votable;JsVotable.Binary=Binary;JsVotable.Binary2=Binary2;JsVotable.Coosys=Coosys;JsVotable.Data=Data;JsVotable.Definitions=Definitions;JsVotable.Description=Description;JsVotable.Field=Field;JsVotable.Fieldref=Fieldref;JsVotable.Fits=Fits;JsVotable.Group=Group;JsVotable.Info=Info;JsVotable.Link=Link;JsVotable.Max=Max;JsVotable.Min=Min;JsVotable.Option=Option;JsVotable.Param=Param;JsVotable.Paramref=Paramref;JsVotable.Resource=Resource;JsVotable.Stream=Stream;JsVotable.Table=Table;JsVotable.TableData=TableData;JsVotable.Td=Td;JsVotable.Tr=Tr;JsVotable.Values=Values;JsVotable.version={major:2,minor:0,patch:0,date:"2019-02-08",toString:function(){return this.major+"."+this.minor+"."+this.patch}};window.JsVotable=JsVotable;return JsVotable});require(["JsVotable"]);
