/*******************************************************************************
 * Copyright 2016 - Jean-Christophe Malapert
 *
 * This file is part of JsVotable.
 *
 * JsVotable is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * JVotable is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with JVotable.  If not, see <http://www.gnu.org/licenses/>.
 ******************************************************************************/

!function(){function t(t){"use strict";var e,r,n;return e=new ArrayBuffer(2),r=new DataView(e),n=t.join(""),r.setUint16(0,parseInt(n,2)),r.getInt16(0)}function e(t){"use strict";var e,r,n;return e=new ArrayBuffer(4),r=new DataView(e),n=t.join(""),r.setUint32(0,parseInt(n,2)),r.getInt32(0)}function r(t){"use strict";var e,r,n;return e=new ArrayBuffer(4),r=new DataView(e),n=t.join(""),r.setUint32(0,parseInt(n,2)),r.getFloat32(0)}function n(t){"use strict";var e,r,n;return e=new ArrayBuffer(8),r=new DataView(e),n=t.slice(0,32).join(""),r.setUint32(0,parseInt(n,2)),n="",n=t.slice(32,64).join(""),r.setUint32(4,parseInt(n,2)),r.getFloat64(0)}function o(t){"use strict";var e,r,n;return e=new ArrayBuffer(1),r=new DataView(e),n=t.join(""),r.setUint8(0,parseInt(n,2)),r.getUint8(0)}function s(t){"use strict";var e,r,n,i,s;for(e=t.length/8,r=[],s="",i=0,n=0;n<e;n+=1)r=t.slice(i,i+8),s=s.concat(String.fromCharCode(o(r))),r=[],i+=8;return s}function u(t){"use strict";var e,r,n;return e=new ArrayBuffer(4),r=new DataView(e),n=t.join(""),r.setUint32(0,parseInt(n,2)),r.getUint32(0)}function a(t){var e;return t>64&&t<91?e=t-65:t>96&&t<123?e=t-71:t>47&&t<58?e=t+4:43===t?e=62:47===t&&(e=63),e}var p={};p.inherits=function(t,e){function r(){}r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e},p.makeHttpObject=function(){try{return new XMLHttpRequest}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(t){}try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(t){}throw Error("The object creation for making HTTP requests has failed.")},p.guid=function(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()},p.findValueByKeyword=function(t,e){var r=void 0;for(i=0;i<t.length;i++){var n=t[i];if(n[0]===e){r=n[1];break}}return r},p.parseXML=function(t){if(document.implementation&&document.implementation.createDocument)xmlDoc=(new DOMParser).parseFromString(t,"text/xml");else{if(!window.ActiveXObject)return alert("Your browser cannot handle this script"),null;xmlDoc=new ActiveXObject("Microsoft.XMLDOM"),xmlDoc.loadXML(t)}return xmlDoc};var c=function(){this.nodeID={},this.nodeName={}};c.prototype.getEltsByID=function(){return this.nodeID},c.prototype.getEltsByName=function(){return this.nodeName},c.prototype.addEntryID=function(t,e){this.nodeID[t]=e},c.prototype.addEntryName=function(t,e){this.nodeName.hasOwnProperty(t)?this.nodeName[t].push(e):(this.nodeName[t]=[],this.nodeName[t].push(e))};var h=function(t){if(this.attributes={},null!=t&&1==t.nodeType){for(var e=0,r=t.attributes.length;e<r;e++){var n=t.attributes[e];this.attributes[n.name]=n.value}if(this.attributes.hasOwnProperty("ID")){var o=f.getInstance();o.addEntryID(this.attributes.ID,this)}if(this.attributes.hasOwnProperty("name")){var o=f.getInstance();o.addEntryName(this.attributes.name,this)}}};h.prototype.getAttributes=function(){return this.attributes},h.prototype.hasAttribute=function(t){return this.attributes.hasOwnProperty(t)},h.prototype.hasAttributes=function(){return 0!=Object.keys(this.attributes).length},h.prototype.getCache=function(){return f.getInstance()};var f=function(){function t(){var t=new c;return t}var e;return{getInstance:function(){return e||(e=t()),e}}}(),l=function(t){h.prototype.constructor.call(this,t),this.value;var e=t.childNodes[0];null!=e&&3==e.nodeType&&(this.value=null==e.textContent?null:e.textContent.trim())};p.inherits(h,l),l.prototype.getContent=function(){return this.value};var y=function(t){h.prototype.constructor.call(this,t)};p.inherits(h,y),y.prototype.ref=function(){return this.attributes.ref},y.prototype.ucd=function(){return this.attributes.ucd},y.prototype.utype=function(){return this.attributes.utype};var d=function(t){h.prototype.constructor.call(this,t)};p.inherits(h,d),d.prototype.ref=function(){return this.attributes.ref},d.prototype.ucd=function(){return this.attributes.ucd},d.prototype.utype=function(){return this.attributes.utype};var v=function(t){h.prototype.constructor.call(this,t)};p.inherits(h,v),v.prototype.value=function(){return this.attributes.value},v.prototype.inclusive=function(){return this.attributes.inclusive};var m=function(t){h.prototype.constructor.call(this,t)};p.inherits(h,m),m.prototype.value=function(){return this.attributes.value},m.prototype.inclusive=function(){return this.attributes.inclusive};var b=function(t){h.prototype.constructor.call(this,t),this.options=w(t)},w=function(t){for(var e=[],r=0;null!=t&&r<t.childNodes.length;r++){var n=t.childNodes[r];if(1==n.nodeType){var o=n.localName;if("OPTION"!=o)throw"Unknown element";e.push(new b(n))}}return e};p.inherits(h,b),b.prototype.name=function(){return this.attributes.name},b.prototype.value=function(){return this.attributes.value},b.prototype.getOptions=function(){return this.options};var g=function(t){h.prototype.constructor.call(this,t);var e=N(t);this.min=e[0],this.max=e[1],this.options=e[2]},N=function(t){for(var e,r,n=[],o=0;null!=t&&o<t.childNodes.length;o++){var i=t.childNodes[o];if(1==i.nodeType){var s=i.localName;if("MIN"==s)e=new v(i);else if("MAX"==s)r=new m(i);else{if("OPTION"!=s)throw"Unknown element";n.push(new b(i))}}}return[e,r,n]};p.inherits(h,g),g.prototype.ID=function(){return this.attributes.ID},g.prototype.type=function(){return this.attributes.type},g.prototype.null=function(){return this.attributes.null},g.prototype.ref=function(){return this.attributes.ref},g.prototype.getMin=function(){return this.min},g.prototype.getMax=function(){return this.max},g.prototype.getOptions=function(){return this.options};var I=function(t){h.prototype.constructor.call(this,t)};p.inherits(h,I),I.prototype.ID=function(){return this.attributes.ID},I.prototype.content_role=function(){return this.attributes["content-role"]},I.prototype.content_type=function(){return this.attributes["content-type"]},I.prototype.title=function(){return this.attributes.title},I.prototype.value=function(){return this.attributes.value},I.prototype.href=function(){return this.attributes.href},I.prototype.gref=function(){return this.attributes.gref},I.prototype.action=function(){return this.attributes.action};var D=function(t){h.prototype.constructor.call(this,t);var e=T(t);this.description=e[0],this.values=e[1],this.links=e[2]},T=function(t){for(var e,r,n=[],o=0;null!=t&&o<t.childNodes.length;o++){var i=t.childNodes[o];if(1==i.nodeType){var s=i.localName;if("DESCRIPTION"==s)e=new l(i);else if("VALUES"==s)r=new g(i);else{if("LINK"!=s)throw"Unknown element";n.push(new I(i))}}}return[e,r,n]};p.inherits(h,D),D.prototype.ID=function(){return this.attributes.ID},D.prototype.unit=function(){return this.attributes.unit},D.prototype.datatype=function(){return this.attributes.datatype},D.prototype.precision=function(){return this.attributes.precision},D.prototype.width=function(){return this.attributes.width},D.prototype.xtype=function(){return this.attributes.xtype},D.prototype.ref=function(){return this.attributes.ref},D.prototype.name=function(){return this.attributes.name},D.prototype.ucd=function(){return this.attributes.ucd},D.prototype.utype=function(){return this.attributes.utype},D.prototype.arraysize=function(){return this.attributes.arraysize},D.prototype.type=function(){return this.attributes.type},D.prototype.getDescription=function(){return this.description},D.prototype.getValues=function(){return this.values},D.prototype.getLinks=function(){return this.links};var O=function(t){D.prototype.constructor.call(this,t)};p.inherits(D,O),O.prototype.value=function(){return this.attributes.value};var A=function(t){h.prototype.constructor.call(this,t);var e=S(t);this.description=e[0],this.fieldrefs=e[1],this.paramrefs=e[2],this.params=e[3],this.groups=e[4]},S=function(t){for(var e,r=[],n=[],o=[],i=[],s=0;null!=t&&s<t.childNodes.length;s++){var u=t.childNodes[s];if(1==u.nodeType){var a=u.localName;if("DESCRIPTION"==a)e=new l(u);else if("FIELDref"==a)r.push(new y(u));else if("PARAMref"==a)n.push(new d(u));else if("PARAM"==a)o.push(new O(u));else{if("GROUP"!=a)throw"Unknown element";i.push(new A(u))}}}return[e,r,n,o,i]};p.inherits(h,A),A.prototype.ID=function(){return this.attributes.ID},A.prototype.name=function(){return this.attributes.name},A.prototype.ref=function(){return this.attributes.ref},A.prototype.ucd=function(){return this.attributes.ucd},A.prototype.utype=function(){return this.attributes.utype},A.prototype.getDescription=function(){return this.description},A.prototype.getFieldrefs=function(){return this.fieldrefs},A.prototype.getParamrefs=function(){return this.paramrefs},A.prototype.getParams=function(){return this.params},A.prototype.getGroups=function(){return this.groups};var C=function(t){h.prototype.constructor.call(this,t),this.value=U(t)};p.inherits(h,C);var U=function(t){for(var e,r=0;null!=t&&r<t.childNodes.length;r++){var n=t.childNodes[r];if(null==n||3!=n.nodeType)throw"Unknown element";e=null==n.textContent?null:n.textContent.trim()}return e};C.prototype.ID=function(){return this.attributes.ID},C.prototype.equinox=function(){return this.attributes.equinox},C.prototype.epoch=function(){return this.attributes.epoch},C.prototype.system=function(){return this.attributes.system},C.prototype.getContent=function(){return this.value};var E=function(t){h.prototype.constructor.call(this,t);var e=P(t);this.coosys=e[0],this.param=e[1]},P=function(t){for(var e=[],r=[],n=0;null!=t&&n<t.childNodes.length;n++){var o=t.childNodes[n];if(1==o.nodeType){var i=o.localName;if("COOSYS"==i)e.push(new C(o));else{if("PARAM"!=i)throw"Unknown element";r.push(new O(o))}}}return[e,r]};p.inherits(h,E),E.prototype.getCoosyss=function(){return this.coosys},E.prototype.getParams=function(){return this.param};var k=function(t){h.prototype.constructor.call(this,t);var e=t.childNodes[0];null!=e&&3==e.nodeType&&(this.value=null==e.textContent?null:e.textContent.trim())};k.prototype.name=function(){return this.attributes.name},k.prototype.value=function(){return this.attributes.value},k.prototype.ID=function(){return this.attributes.ID},k.prototype.unit=function(){return this.attributes.unit},k.prototype.xtype=function(){return this.attributes.xtype},k.prototype.ref=function(){return info.ref},k.prototype.ucd=function(){return this.attributes.ucd},k.prototype.utype=function(){return this.attributes.utype},k.prototype.getContent=function(){return this.value};var x=function(t){h.prototype.constructor.call(this,t),this.value=null==t.textContent?null:t.textContent.trim()};p.inherits(h,x),x.prototype.encoding=function(){return this.attributes.encoding},x.prototype.getContent=function(){return this.value};var B=function(t){h.prototype.constructor.call(this,t),this.tds=R(t)},R=function(t){for(var e=[],r=0;null!=t&&r<t.childNodes.length;r++){var n=t.childNodes[r];if(1==n.nodeType){var o=n.localName;if("TD"!=o)throw"Unknown element";e.push(new x(n))}}return e};p.inherits(h,B),B.prototype.ID=function(){return this.attributes.ID},B.prototype.getTds=function(){return this.tds};var L=function(t,e){h.prototype.constructor.call(this,t),this.name=e};p.inherits(h,L),L.prototype.getName=function(){return this.name};var M=function(t,e){L.prototype.constructor.call(this,t,"TableData"),null==e?this.trs=F(t):this.trs=e},F=function(t){for(var e=[],r=0;null!=t&&r<t.childNodes.length;r++){var n=t.childNodes[r];if(1==n.nodeType){var o=n.localName;if("TR"!=o)throw"Unknown element";e.push(new B(n))}}return e};p.inherits(L,M),M.prototype.getTrs=function(){return this.trs};var V={short:16,int:32,float:32,double:64,unsignedByte:8},j=function(t){this.ptrStream=0,this.bufferTabBits=[],this.fields=t};j.prototype.computeDataSize=function(t,e,r){var n=0;if("char"===t)if(/\*/.test(this.fields[e].arraysize())){var o=this.streamB64(32,r);n=8*u(o),o=[]}else n=8*this.fields[e].arraysize();else n=V[t];return n},j.prototype.streamB64=function(t,e){var r=[],n=this.bufferTabBits.length,o=Math.ceil((t-n)/6);for(i=0;i<n;i+=1)r.push(this.bufferTabBits[i]);for(this.bufferTabBits=[],i=0;i<o;i+=1){if(10==e.charCodeAt(this.ptrStream))i-=1;else{var s=a(e.charCodeAt(this.ptrStream));for(z=32;z>0;z>>=1)r.length!==t?r.push((s&z)===z?"1":"0"):this.bufferTabBits.push((s&z)===z?"1":"0")}this.ptrStream+=1}return r},j.prototype.decodeValue=function(i,u,a,p){var c,h=[];switch("NULL"!=i&&(h=this.streamB64(u,p)),i){case"short":c=t(h);break;case"int":c=e(h);break;case"float":c=r(h),c=c.toFixed(this.fields[a].precision());break;case"double":c=n(h),c=c.toFixed(this.fields[a].precision());break;case"unsignedByte":c=o(h);break;case"char":c=s(h);break;case"NULL":c="NULL"}return"NaN"!==c&&"NULL"!==c&&0!==c||(c=""),c},j.prototype.decode=function(t){var e=[],r=0,n=t.length,o=this.fields.length,i=[];do{var s=this.fields[r].datatype(),u=this.computeDataSize(s,r,t);0==u&&(s="NULL");var a=this.decodeValue(s,u,r,t);i.push(a),r===o-1?(r=0,e.push(i),i=[]):r+=1}while(this.ptrStream<n);return e};var X=function(t){h.prototype.constructor.call(this,t),this.value=t.textContent};p.inherits(h,X),X.prototype.type=function(){return this.attributes.type},X.prototype.href=function(){return this.attributes.href},X.prototype.actuate=function(){return this.attributes.actuate},X.prototype.encoding=function(){return this.attributes.encoding},X.prototype.expires=function(){return this.attributes.expires},X.prototype.rights=function(){return this.attributes.rights},X.prototype.getContent=function(t,e){var r;if(null==t||0==t)r=this.value;else{var n=new j(e);r=new M(null,n.decode(this.value))}return r};var G=function(t){L.prototype.constructor.call(this,t,"Binary"),this.stream=q(t)},q=function(t){for(var e,r=0;null!=t&&r<t.childNodes.length;r++){var n=t.childNodes[r];if(1==n.nodeType){var o=n.localName;if("STREAM"!=o)throw"Unknown element";e=new X(n)}}return e};p.inherits(L,G),G.prototype.getStream=function(){return this.stream};var Y=function(t){L.prototype.constructor.call(this,t,"Binary2"),this.stream=H(t)},H=function(t){for(var e,r=0;null!=t&&r<t.childNodes.length;r++){var n=t.childNodes[r];if(1==n.nodeType){var o=n.localName;if("STREAM"!=o)throw"Unknown element";e=new E(n)}}return e};p.inherits(L,Y),Y.prototype.getStream=function(){return this.stream};var K=function(t){L.prototype.constructor.call(this,t,"Fits"),this.stream=_(t)},_=function(t){for(var e,r=0;null!=t&&r<t.childNodes.length;r++){var n=t.childNodes[r];if(1==n.nodeType){var o=n.localName;if("STREAM"!=o)throw"Unknown element";e=new E(n)}}return e};p.inherits(L,K),K.prototype.getStream=function(){return this.stream},K.prototype.extnum=function(){return this.attributes.extnum};var J=function(t){h.prototype.constructor.call(this,t);var e=Q(t);this.data=e[0],this.infos=e[1]},Q=function(t){for(var e,r=[],n=0;null!=t&&n<t.childNodes.length;n++){var o=t.childNodes[n];if(1==o.nodeType){var i=o.localName;if("TABLEDATA"==i)e=new M(o);else if("BINARY"==i)e=new G(o);else if("BINARY2"==i)e=new Y(o);else if("FITS"==i)e=new K(o);else{if("INFO"!=i)throw"Unknown element";r.push(new k(o))}}}return[e,r]};p.inherits(h,J),J.prototype.getData=function(){return this.data},J.prototype.getDataImplementationName=function(){return this.data.getName()},J.prototype.getInfos=function(){return this.infos};var W=function(t){h.prototype.constructor.call(this,t);var e=Z(t);this.fields=e[0],this.params=e[1],this.groups=e[2],this.links=e[3],this.data=e[4],this.description=e[5],this.infos=e[6]},Z=function(t){for(var e,r,n=[],o=[],i=[],s=[],u=[],a=0;null!=t&&a<t.childNodes.length;a++){var p=t.childNodes[a];if(1==p.nodeType){var c=p.localName;if("DESCRIPTION"==c)r=new l(p);else if("FIELD"==c)n.push(new D(p));else if("PARAM"==c)o.push(new O(p));else if("GROUP"==c)i.push(new A(p));else if("LINK"==c)s.push(new I(p));else if("DATA"==c)e=new J(p);else{if("INFO"!=c)throw"Unknown element";u.push(new k(p))}}}return[n,o,i,s,e,r,u]};p.inherits(h,W),W.prototype.ID=function(){return this.attributes.ID},W.prototype.name=function(){return this.attributes.name},W.prototype.ref=function(){return this.attributes.ref},W.prototype.ucd=function(){return this.attributes.ucd},W.prototype.utype=function(){return this.attributes.utype},W.prototype.nrows=function(){return this.attributes.nrows},W.prototype.getFields=function(){return this.fields},W.prototype.getParams=function(){return this.params},W.prototype.getGroups=function(){return this.groups},W.prototype.getLinks=function(){return this.links},W.prototype.getData=function(){return this.data},W.prototype.getInfos=function(){return this.infos};var $=function(t){h.prototype.constructor.call(this,t);var e=tt(t);this.description=e[0],this.infos=e[1],this.coosyss=e[2],this.params=e[3],this.groups=e[4],this.abstractSequences=e[5]},tt=function(t){for(var e,r=[],n=[],o=[],i=[],s=[],u=0,a=0;null!=t&&a<t.childNodes.length;a++){var p=t.childNodes[a];if(1==p.nodeType){var c=p.localName;if("DESCRIPTION"==c)e=new l(p);else if("INFO"==c)r.push(new k(p));else if("COOSYS"==c)n.push(new C);else if("GROUP"==c)o.push(new A);else{if("PARAM"!=c){u=a;break}i.push(new O)}}}for(var h={},f=[],y=[],a=u;null!=t&&a<t.childNodes.length;a++){var p=t.childNodes[a];1==p.nodeType&&("LINK"==c?h.hasOwnProperty("TABLE")||h.hasOwnProperty("RESOURCE")?(h.LINKS=f,h.INFOS=y,this.abstractSequences.push(h),h={},f=[],y=[]):f.push(new I(p)):"TABLE"==c?h.TABLE=new W(p):"RESOURCE"==c?h.RESOURCE=new $(p):"INFO"==c&&y.push(new k(p)))}return 0!=Object.keys(h).length&&s.push(h),[e,r,n,i,o,s]};p.inherits(h,$),$.prototype.ID=function(){return this.attributes.ID},$.prototype.name=function(){return this.attributes.name},$.prototype.utype=function(){return this.attributes.utype},$.prototype.type=function(){return this.attributes.type},$.prototype.getDescription=function(){return this.description},$.prototype.getInfos=function(){return this.infos},$.prototype.getCoosyss=function(){return this.coosyss},$.prototype.getGroups=function(){return this.groups},$.prototype.getParams=function(){return this.params},$.prototype.getResourcesOrTables=function(){return this.abstractSequences};var et=function(t){if(null==t)throw"xml cannot be null";var e=t.documentElement;h.prototype.constructor.call(this,e);var r=rt(e);this.definitions=r[0],this.infos=r[1],this.resources=r[2],this.description=r[3],this.coosyss=r[4],this.groups=r[5],this.params=r[6]},rt=function(t){for(var e,r,n=t,o=[],i=[],s=[],u=[],a=[],p=0;p<n.childNodes.length;p++){var c=n.childNodes[p];if(1==c.nodeType){var h=c.localName;if("DEFINITIONS"==h)e=new E(c);else if("INFO"==h)o.push(new k(c));else if("RESOURCE"==h)i.push(new $(c));else if("DESCRIPTION"==h)r=new l(c);else if("COOSYS"==h)s.push(new C(c));else if("GROUP"==h)u.push(new A(c));else{if("PARAM"!=h)throw"Unknown element";a.push(new O(c))}}}return[e,o,i,r,s,u,a]};p.inherits(h,et),et.prototype.ID=function(){return this.attributes.ID},et.prototype.version=function(){return this.attributes.version},et.prototype.getInfos=function(){return this.infos},et.prototype.getDefinitions=function(){return this.definitions},et.prototype.getResources=function(){return this.resources},et.prototype.getCoosyss=function(){return this.coosyss},et.prototype.getGroups=function(){return this.groups},et.prototype.getParams=function(){return this.params},et.prototype.getDescription=function(){return this.description},et.prototype.getVotableEltByID=function(t){return this.getCache().getEltsByID()[t]},et.prototype.getVotableEltsByName=function(t){return this.getCache().getEltsByName()[t]};var nt={};return nt.Votable=et,nt.Binary=G,nt.Binary2=Y,nt.Coosys=C,nt.Data=J,nt.Definitions=E,nt.Description=l,nt.Field=D,nt.Fieldref=y,nt.Fits=K,nt.Group=A,nt.Info=k,nt.Link=I,nt.Max=m,nt.Min=v,nt.Option=b,nt.Param=O,nt.Paramref=d,nt.Resource=$,nt.Stream=X,nt.Table=W,nt.TableData=M,nt.Td=x,nt.Tr=B,nt.Values=g,window.JsVotable=nt,nt}();