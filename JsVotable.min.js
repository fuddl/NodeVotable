/*******************************************************************************
 * Copyright 2016 - Jean-Christophe Malapert
 *
 * This file is part of JsVotable.
 *
 * JsVotable is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * JVotable is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with JVotable.  If not, see <http://www.gnu.org/licenses/>.
 ******************************************************************************/

!function(){function t(t){"use strict";var e,n,r;return e=new ArrayBuffer(2),n=new DataView(e),r=t.join(""),n.setUint16(0,parseInt(r,2)),n.getInt16(0)}function e(t){"use strict";var e,n,r;return e=new ArrayBuffer(4),n=new DataView(e),r=t.join(""),n.setUint32(0,parseInt(r,2)),n.getInt32(0)}function n(t){"use strict";var e,n,r;return e=new ArrayBuffer(4),n=new DataView(e),r=t.join(""),n.setUint32(0,parseInt(r,2)),n.getFloat32(0)}function r(t){"use strict";var e,n,r;return e=new ArrayBuffer(8),n=new DataView(e),r=t.slice(0,32).join(""),n.setUint32(0,parseInt(r,2)),r="",r=t.slice(32,64).join(""),n.setUint32(4,parseInt(r,2)),n.getFloat64(0)}function o(t){"use strict";var e,n,r;return e=new ArrayBuffer(1),n=new DataView(e),r=t.join(""),n.setUint8(0,parseInt(r,2)),n.getUint8(0)}function s(t){"use strict";var e,n,r,i,s;for(e=t.length/8,n=[],s="",i=0,r=0;r<e;r+=1)n=t.slice(i,i+8),s=s.concat(String.fromCharCode(o(n))),n=[],i+=8;return s}function u(t){"use strict";var e,n,r;return e=new ArrayBuffer(4),n=new DataView(e),r=t.join(""),n.setUint32(0,parseInt(r,2)),n.getUint32(0)}function a(t){var e;return t>64&&t<91?e=t-65:t>96&&t<123?e=t-71:t>47&&t<58?e=t+4:43===t?e=62:47===t&&(e=63),e}var p={};p.inherits=function(t,e){function n(){}n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e},p.makeHttpObject=function(){try{return new XMLHttpRequest}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(t){}try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(t){}throw Error("The object creation for making HTTP requests has failed.")},p.guid=function(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()},p.findValueByKeyword=function(t,e){var n=void 0;for(i=0;i<t.length;i++){var r=t[i];if(r[0]===e){n=r[1];break}}return n},p.parseXML=function(t){if(document.implementation&&document.implementation.createDocument)xmlDoc=(new DOMParser).parseFromString(t,"text/xml");else{if(!window.ActiveXObject)return alert("Your browser cannot handle this script"),null;xmlDoc=new ActiveXObject("Microsoft.XMLDOM"),xmlDoc.loadXML(t)}return xmlDoc};var c=function(){this.nodeID={},this.nodeName={}};c.prototype.getEltsByID=function(){return this.nodeID},c.prototype.getEltsByName=function(){return this.nodeName},c.prototype.addEntryID=function(t,e){this.nodeID[t]=e},c.prototype.addEntryName=function(t,e){this.nodeName.hasOwnProperty(t)?this.nodeName[t].push(e):(this.nodeName[t]=[],this.nodeName[t].push(e))};var h=function(t){if(this.attributes={},null!=t&&1==t.nodeType){for(var e=0,n=t.attributes.length;e<n;e++){var r=t.attributes[e];this.attributes[r.name]=r.value}if(this.attributes.hasOwnProperty("ID")){var o=l.getInstance();o.addEntryID(this.attributes.ID,this)}if(this.attributes.hasOwnProperty("name")){var o=l.getInstance();o.addEntryName(this.attributes.name,this)}}};h.prototype.getAttributes=function(){return this.attributes},h.prototype.hasAttribute=function(t){return this.attributes.hasOwnProperty(t)},h.prototype.hasAttributes=function(){return 0!=Object.keys(this.attributes).length},h.prototype.getCache=function(){return l.getInstance()};var l=function(){function t(){var t=new c;return t}var e;return{getInstance:function(){return e||(e=t()),e}}}(),f=function(t){h.prototype.constructor.call(this,t),this.value;var e=t.childNodes[0];null!=e&&3==e.nodeType&&(this.value=null==e.textContent?null:e.textContent.trim())};p.inherits(h,f),f.prototype.getContent=function(){return this.value};var y=function(t){h.prototype.constructor.call(this,t)};p.inherits(h,y),y.prototype.ref=function(){return this.attributes.ref},y.prototype.ucd=function(){return this.attributes.ucd},y.prototype.utype=function(){return this.attributes.utype};var d=function(t){h.prototype.constructor.call(this,t)};p.inherits(h,d),d.prototype.ref=function(){return this.attributes.ref},d.prototype.ucd=function(){return this.attributes.ucd},d.prototype.utype=function(){return this.attributes.utype};var v=function(t){h.prototype.constructor.call(this,t)};p.inherits(h,v),v.prototype.value=function(){return this.attributes.value},v.prototype.inclusive=function(){return this.attributes.inclusive};var m=function(t){h.prototype.constructor.call(this,t)};p.inherits(h,m),m.prototype.value=function(){return this.attributes.value},m.prototype.inclusive=function(){return this.attributes.inclusive};var b=function(t){h.prototype.constructor.call(this,t),this.options=w(t)},w=function(t){for(var e=[],n=0;null!=t&&n<t.childNodes.length;n++){var r=t.childNodes[n];if(1==r.nodeType){var o=r.localName;"OPTION"==o?e.push(new b(r)):console.warn("unknown element "+o+" in Option node")}}return e};p.inherits(h,b),b.prototype.name=function(){return this.attributes.name},b.prototype.value=function(){return this.attributes.value},b.prototype.getOptions=function(){return this.options};var g=function(t){h.prototype.constructor.call(this,t);var e=N(t);this.min=e[0],this.max=e[1],this.options=e[2]},N=function(t){for(var e,n,r=[],o=0;null!=t&&o<t.childNodes.length;o++){var i=t.childNodes[o];if(1==i.nodeType){var s=i.localName;"MIN"==s?e=new v(i):"MAX"==s?n=new m(i):"OPTION"==s?r.push(new b(i)):console.warn("unknown element "+s+" in Values node")}}return[e,n,r]};p.inherits(h,g),g.prototype.ID=function(){return this.attributes.ID},g.prototype.type=function(){return this.attributes.type},g.prototype.null=function(){return this.attributes.null},g.prototype.ref=function(){return this.attributes.ref},g.prototype.getMin=function(){return this.min},g.prototype.getMax=function(){return this.max},g.prototype.getOptions=function(){return this.options};var I=function(t){h.prototype.constructor.call(this,t)};p.inherits(h,I),I.prototype.ID=function(){return this.attributes.ID},I.prototype.content_role=function(){return this.attributes["content-role"]},I.prototype.content_type=function(){return this.attributes["content-type"]},I.prototype.title=function(){return this.attributes.title},I.prototype.value=function(){return this.attributes.value},I.prototype.href=function(){return this.attributes.href},I.prototype.gref=function(){return this.attributes.gref},I.prototype.action=function(){return this.attributes.action};var D=function(t){h.prototype.constructor.call(this,t);var e=T(t);this.description=e[0],this.values=e[1],this.links=e[2]},T=function(t){for(var e,n,r=[],o=0;null!=t&&o<t.childNodes.length;o++){var i=t.childNodes[o];if(1==i.nodeType){var s=i.localName;"DESCRIPTION"==s?e=new f(i):"VALUES"==s?n=new g(i):"LINK"==s?r.push(new I(i)):console.warn("unknown element "+s+" in Field node")}}return[e,n,r]};p.inherits(h,D),D.prototype.ID=function(){return this.attributes.ID},D.prototype.unit=function(){return this.attributes.unit},D.prototype.datatype=function(){return this.attributes.datatype},D.prototype.precision=function(){return this.attributes.precision},D.prototype.width=function(){return this.attributes.width},D.prototype.xtype=function(){return this.attributes.xtype},D.prototype.ref=function(){return this.attributes.ref},D.prototype.name=function(){return this.attributes.name},D.prototype.ucd=function(){return this.attributes.ucd},D.prototype.utype=function(){return this.attributes.utype},D.prototype.arraysize=function(){return this.attributes.arraysize},D.prototype.type=function(){return this.attributes.type},D.prototype.getDescription=function(){return this.description},D.prototype.getValues=function(){return this.values},D.prototype.getLinks=function(){return this.links};var O=function(t){D.prototype.constructor.call(this,t)};p.inherits(D,O),O.prototype.value=function(){return this.attributes.value};var A=function(t){h.prototype.constructor.call(this,t);var e=S(t);this.description=e[0],this.fieldrefs=e[1],this.paramrefs=e[2],this.params=e[3],this.groups=e[4]},S=function(t){for(var e,n=[],r=[],o=[],i=[],s=0;null!=t&&s<t.childNodes.length;s++){var u=t.childNodes[s];if(1==u.nodeType){var a=u.localName;"DESCRIPTION"==a?e=new f(u):"FIELDref"==a?n.push(new y(u)):"PARAMref"==a?r.push(new d(u)):"PARAM"==a?o.push(new O(u)):"GROUP"==a?i.push(new A(u)):console.warn("unknown element "+a+" in Group node")}}return[e,n,r,o,i]};p.inherits(h,A),A.prototype.ID=function(){return this.attributes.ID},A.prototype.name=function(){return this.attributes.name},A.prototype.ref=function(){return this.attributes.ref},A.prototype.ucd=function(){return this.attributes.ucd},A.prototype.utype=function(){return this.attributes.utype},A.prototype.getDescription=function(){return this.description},A.prototype.getFieldrefs=function(){return this.fieldrefs},A.prototype.getParamrefs=function(){return this.paramrefs},A.prototype.getParams=function(){return this.params},A.prototype.getGroups=function(){return this.groups};var C=function(t){h.prototype.constructor.call(this,t),this.value=E(t)};p.inherits(h,C);var E=function(t){for(var e,n=0;null!=t&&n<t.childNodes.length;n++){var r=t.childNodes[n];null!=r&&3==r.nodeType?e=null==r.textContent?null:r.textContent.trim():console.warn("unknown element "+r+" in Coosys node")}return e};C.prototype.ID=function(){return this.attributes.ID},C.prototype.equinox=function(){return this.attributes.equinox},C.prototype.epoch=function(){return this.attributes.epoch},C.prototype.system=function(){return this.attributes.system},C.prototype.getContent=function(){return this.value};var P=function(t){h.prototype.constructor.call(this,t);var e=B(t);this.coosys=e[0],this.param=e[1]},B=function(t){for(var e=[],n=[],r=0;null!=t&&r<t.childNodes.length;r++){var o=t.childNodes[r];if(1==o.nodeType){var i=o.localName;"COOSYS"==i?e.push(new C(o)):"PARAM"==i?n.push(new O(o)):console.warn("unknown element "+i+" in Definitions node")}}return[e,n]};p.inherits(h,P),P.prototype.getCoosyss=function(){return this.coosys},P.prototype.getParams=function(){return this.param};var k=function(t){h.prototype.constructor.call(this,t);var e=t.childNodes[0];null!=e&&3==e.nodeType&&(this.value=null==e.textContent?null:e.textContent.trim())};k.prototype.name=function(){return this.attributes.name},k.prototype.value=function(){return this.attributes.value},k.prototype.ID=function(){return this.attributes.ID},k.prototype.unit=function(){return this.attributes.unit},k.prototype.xtype=function(){return this.attributes.xtype},k.prototype.ref=function(){return this.attributes.ref},k.prototype.ucd=function(){return this.attributes.ucd},k.prototype.utype=function(){return this.attributes.utype},k.prototype.getContent=function(){return this.value};var x=function(t){h.prototype.constructor.call(this,t),this.value=null==t.textContent?null:t.textContent.trim()};p.inherits(h,x),x.prototype.encoding=function(){return this.attributes.encoding},x.prototype.getContent=function(){return this.value};var R=function(t){h.prototype.constructor.call(this,t),this.tds=L(t)},L=function(t){for(var e=[],n=0;null!=t&&n<t.childNodes.length;n++){var r=t.childNodes[n];if(1==r.nodeType){var o=r.localName;"TD"==o?e.push(new x(r)):console.warn("unknown element "+o+" in Tr node")}}return e};p.inherits(h,R),R.prototype.ID=function(){return this.attributes.ID},R.prototype.getTds=function(){return this.tds};var M=function(t,e){h.prototype.constructor.call(this,t),this.name=e};p.inherits(h,M),M.prototype.getName=function(){return this.name};var U=function(t,e){M.prototype.constructor.call(this,t,"TableData"),null==e?this.trs=F(t):this.trs=e},F=function(t){for(var e=[],n=0;null!=t&&n<t.childNodes.length;n++){var r=t.childNodes[n];if(1==r.nodeType){var o=r.localName;"TR"==o?e.push(new R(r)):console.warn("unknown element "+o+" in TableData node")}}return e};p.inherits(M,U),U.prototype.getTrs=function(){return this.trs};var V={short:16,int:32,float:32,double:64,unsignedByte:8},j=function(t){this.ptrStream=0,this.bufferTabBits=[],this.fields=t};j.prototype.computeDataSize=function(t,e,n){var r=0;if("char"===t)if(/\*/.test(this.fields[e].arraysize())){var o=this.streamB64(32,n);r=8*u(o),o=[]}else r=8*this.fields[e].arraysize();else r=V[t];return r},j.prototype.streamB64=function(t,e){var n=[],r=this.bufferTabBits.length,o=Math.ceil((t-r)/6);for(i=0;i<r;i+=1)n.push(this.bufferTabBits[i]);for(this.bufferTabBits=[],i=0;i<o;i+=1){if(10==e.charCodeAt(this.ptrStream))i-=1;else{var s=a(e.charCodeAt(this.ptrStream));for(z=32;z>0;z>>=1)n.length!==t?n.push((s&z)===z?"1":"0"):this.bufferTabBits.push((s&z)===z?"1":"0")}this.ptrStream+=1}return n},j.prototype.decodeValue=function(i,u,a,p){var c,h=[];switch("NULL"!=i&&(h=this.streamB64(u,p)),i){case"short":c=t(h);break;case"int":c=e(h);break;case"float":c=n(h),c=c.toFixed(this.fields[a].precision());break;case"double":c=r(h),c=c.toFixed(this.fields[a].precision());break;case"unsignedByte":c=o(h);break;case"char":c=s(h);break;case"NULL":c="NULL"}return"NaN"!==c&&"NULL"!==c&&0!==c||(c=""),c},j.prototype.decode=function(t){var e=[],n=0,r=t.length,o=this.fields.length,i=[];do{var s=this.fields[n].datatype(),u=this.computeDataSize(s,n,t);0==u&&(s="NULL");var a=this.decodeValue(s,u,n,t);i.push(a),n===o-1?(n=0,e.push(i),i=[]):n+=1}while(this.ptrStream<r);return e};var X=function(t){h.prototype.constructor.call(this,t),this.value=t.textContent};p.inherits(h,X),X.prototype.type=function(){return this.attributes.type},X.prototype.href=function(){return this.attributes.href},X.prototype.actuate=function(){return this.attributes.actuate},X.prototype.encoding=function(){return this.attributes.encoding},X.prototype.expires=function(){return this.attributes.expires},X.prototype.rights=function(){return this.attributes.rights},X.prototype.getContent=function(t,e){var n;if(null==t||0==t)n=this.value;else{var r=new j(e);n=new U(null,r.decode(this.value))}return n};var G=function(t){M.prototype.constructor.call(this,t,"Binary"),this.stream=q(t)},q=function(t){for(var e,n=0;null!=t&&n<t.childNodes.length;n++){var r=t.childNodes[n];if(1==r.nodeType){var o=r.localName;if("STREAM"!=o)throw"Unknown element";e=new X(r)}}return e};p.inherits(M,G),G.prototype.getStream=function(){return this.stream};var Y=function(t){M.prototype.constructor.call(this,t,"Binary2"),this.stream=H(t)},H=function(t){for(var e,n=0;null!=t&&n<t.childNodes.length;n++){var r=t.childNodes[n];if(1==r.nodeType){var o=r.localName;"STREAM"==o?e=new P(r):console.warn("unknown element "+o+" in Binary2 node")}}return e};p.inherits(M,Y),Y.prototype.getStream=function(){return this.stream};var K=function(t){M.prototype.constructor.call(this,t,"Fits"),this.stream=_(t)},_=function(t){for(var e,n=0;null!=t&&n<t.childNodes.length;n++){var r=t.childNodes[n];if(1==r.nodeType){var o=r.localName;"STREAM"==o?e=new P(r):console.warn("unknown element "+o+" in Fits node")}}return e};p.inherits(M,K),K.prototype.getStream=function(){return this.stream},K.prototype.extnum=function(){return this.attributes.extnum};var J=function(t){h.prototype.constructor.call(this,t);var e=Q(t);this.data=e[0],this.infos=e[1]},Q=function(t){for(var e,n=[],r=0;null!=t&&r<t.childNodes.length;r++){var o=t.childNodes[r];if(1==o.nodeType){var i=o.localName;"TABLEDATA"==i?e=new U(o):"BINARY"==i?e=new G(o):"BINARY2"==i?e=new Y(o):"FITS"==i?e=new K(o):"INFO"==i?n.push(new k(o)):console.warn("unknown element "+i+" in Data node")}}return[e,n]};p.inherits(h,J),J.prototype.getData=function(){return this.data},J.prototype.getDataImplementationName=function(){return this.data.getName()},J.prototype.getInfos=function(){return this.infos};var W=function(t){h.prototype.constructor.call(this,t);var e=Z(t);this.fields=e[0],this.params=e[1],this.groups=e[2],this.links=e[3],this.data=e[4],this.description=e[5],this.infos=e[6]},Z=function(t){for(var e,n,r=[],o=[],i=[],s=[],u=[],a=0;null!=t&&a<t.childNodes.length;a++){var p=t.childNodes[a];if(1==p.nodeType){var c=p.localName;"DESCRIPTION"==c?n=new f(p):"FIELD"==c?r.push(new D(p)):"PARAM"==c?o.push(new O(p)):"GROUP"==c?i.push(new A(p)):"LINK"==c?s.push(new I(p)):"DATA"==c?e=new J(p):"INFO"==c?u.push(new k(p)):console.warn("unknown element "+c+" in Table node")}}return[r,o,i,s,e,n,u]};p.inherits(h,W),W.prototype.ID=function(){return this.attributes.ID},W.prototype.name=function(){return this.attributes.name},W.prototype.ref=function(){return this.attributes.ref},W.prototype.ucd=function(){return this.attributes.ucd},W.prototype.utype=function(){return this.attributes.utype},W.prototype.nrows=function(){return this.attributes.nrows},W.prototype.getFields=function(){return this.fields},W.prototype.getParams=function(){return this.params},W.prototype.getGroups=function(){return this.groups},W.prototype.getLinks=function(){return this.links},W.prototype.getData=function(){return this.data},W.prototype.getInfos=function(){return this.infos},W.prototype.getDescription=function(){return this.description};var $=function(t){h.prototype.constructor.call(this,t);var e=tt(t);this.description=e[0],this.infos=e[1],this.coosyss=e[2],this.params=e[3],this.groups=e[4],this.abstractSequences=e[5]},tt=function(t){for(var e,n=[],r=[],o=[],i=[],s=[],u=0,a=0;null!=t&&a<t.childNodes.length;a++){var p=t.childNodes[a];if(1==p.nodeType){var c=p.localName;if("DESCRIPTION"==c)e=new f(p);else if("INFO"==c)n.push(new k(p));else if("COOSYS"==c)r.push(new C);else if("GROUP"==c)o.push(new A);else{if("PARAM"!=c){u=a;break}i.push(new O)}}}for(var h={},l=[],y=[],a=u;null!=t&&a<t.childNodes.length;a++){var p=t.childNodes[a];if(1==p.nodeType){var c=p.localName;"LINK"==c?h.hasOwnProperty("TABLE")||h.hasOwnProperty("RESOURCE")?(h.LINKS=l,h.INFOS=y,s.push(h),h={},l=[],y=[]):l.push(new I(p)):"TABLE"==c?h.TABLE=new W(p):"RESOURCE"==c?h.RESOURCE=new $(p):"INFO"==c&&y.push(new k(p))}}return 0!=Object.keys(h).length&&s.push(h),[e,n,r,i,o,s]};p.inherits(h,$),$.prototype.ID=function(){return this.attributes.ID},$.prototype.name=function(){return this.attributes.name},$.prototype.utype=function(){return this.attributes.utype},$.prototype.type=function(){return this.attributes.type},$.prototype.getDescription=function(){return this.description},$.prototype.getInfos=function(){return this.infos},$.prototype.getCoosyss=function(){return this.coosyss},$.prototype.getGroups=function(){return this.groups},$.prototype.getParams=function(){return this.params},$.prototype.getResourcesOrTables=function(){return this.abstractSequences};var et=function(t){if(null==t)throw Error("xml cannot be null");var e=t.documentElement;h.prototype.constructor.call(this,e);var n=nt(e);this.definitions=n[0],this.infos=n[1],this.resources=n[2],this.description=n[3],this.coosyss=n[4],this.groups=n[5],this.params=n[6]},nt=function(t){for(var e,n,r=t,o=[],i=[],s=[],u=[],a=[],p=0;p<r.childNodes.length;p++){var c=r.childNodes[p];if(1==c.nodeType){var h=c.localName;"DEFINITIONS"==h?e=new P(c):"INFO"==h?o.push(new k(c)):"RESOURCE"==h?i.push(new $(c)):"DESCRIPTION"==h?n=new f(c):"COOSYS"==h?s.push(new C(c)):"GROUP"==h?u.push(new A(c)):"PARAM"==h?a.push(new O(c)):console.warn("unknown element "+h+" in Votable node")}}return[e,o,i,n,s,u,a]};p.inherits(h,et),et.prototype.ID=function(){return this.attributes.ID},et.prototype.version=function(){return this.attributes.version},et.prototype.getInfos=function(){return this.infos},et.prototype.getDefinitions=function(){return this.definitions},et.prototype.getResources=function(){return this.resources},et.prototype.getCoosyss=function(){return this.coosyss},et.prototype.getGroups=function(){return this.groups},et.prototype.getParams=function(){return this.params},et.prototype.getDescription=function(){return this.description},et.prototype.getVotableEltByID=function(t){return this.getCache().getEltsByID()[t]},et.prototype.getVotableEltsByName=function(t){return this.getCache().getEltsByName()[t]};var rt={};return rt.Votable=et,rt.Binary=G,rt.Binary2=Y,rt.Coosys=C,rt.Data=J,rt.Definitions=P,rt.Description=f,rt.Field=D,rt.Fieldref=y,rt.Fits=K,rt.Group=A,rt.Info=k,rt.Link=I,rt.Max=m,rt.Min=v,rt.Option=b,rt.Param=O,rt.Paramref=d,rt.Resource=$,rt.Stream=X,rt.Table=W,rt.TableData=U,rt.Td=x,rt.Tr=R,rt.Values=g,rt.version={major:1,minor:0,patch:0,date:"2016-10-12",toString:function(){return this.major+"."+this.minor+"."+this.patch}},window.JsVotable=rt,rt}();